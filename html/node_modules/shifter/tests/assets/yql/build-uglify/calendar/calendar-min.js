YUI.add("calendar",function(e,t){var a=e.ClassNameManager.getClassName,i="calendar",s=(a(i,"header"),a(i,"day-selected")),h=a(i,"day-highlighted"),l=a(i,"day"),n=a(i,"prevmonth-day"),d=a(i,"nextmonth-day"),r=a(i,"grid"),o=e.DataType.Date,c=(e.delegate,a(i,"pane")),u=e.UA.os;e.Calendar=e.extend(function _(e){_.superclass.constructor.apply(this,arguments)},e.CalendarBase,{_keyEvents:[],_highlightedDateNode:null,_lastSelectedDate:null,initializer:function(){this.plug(e.Plugin.CalendarNavigator),this._keyEvents=[],this._highlightedDateNode=null,this._lastSelectedDate=null},_bindCalendarEvents:function(){var e=this.get("contentBox").one("."+c);e.on("selectstart",this._preventSelectionStart),e.delegate("click",this._clickCalendar,"."+l+", ."+n+", ."+d,this),e.delegate("keydown",this._keydownCalendar,"."+r,this),e.delegate("focus",this._focusCalendarGrid,"."+r,this),e.delegate("focus",this._focusCalendarCell,"."+l,this),e.delegate("blur",this._blurCalendarGrid,"."+r+",."+l,this)},_preventSelectionStart:function(e){e.preventDefault()},_highlightDateNode:function(e){this._unhighlightCurrentDateNode();var t=this._dateToNode(e);t.focus(),t.addClass(h)},_unhighlightCurrentDateNode:function(){var e=this.get("contentBox").all("."+h);e&&e.removeClass(h)},_getGridNumber:function(e){var t=e.get("id").split("_").reverse();return parseInt(t[0],10)},_blurCalendarGrid:function(e){this._unhighlightCurrentDateNode()},_focusCalendarCell:function(e){this._highlightedDateNode=e.target,e.stopPropagation()},_focusCalendarGrid:function(e){this._unhighlightCurrentDateNode(),this._highlightedDateNode=null},_keydownCalendar:function(e){var t,a,i,h,l,n=this._getGridNumber(e.target),d=this._highlightedDateNode?this._nodeToDate(this._highlightedDateNode):null,r=e.keyCode,c=0;switch(r){case 40:c=7,"s";break;case 38:c=-7,"n";break;case 37:c=-1,"w";break;case 39:c=1,"e";break;case 32:case 13:e.preventDefault(),this._highlightedDateNode&&("single"!==(t=this.get("selectionMode"))||this._highlightedDateNode.hasClass(s)?"multiple"!==t&&"multiple-sticky"!==t||(this._highlightedDateNode.hasClass(s)?this._removeDateFromSelection(d):this._addDateToSelection(d)):(this._clearSelection(!0),this._addDateToSelection(d)))}40!=r&&38!=r&&37!=r&&39!=r||(d||(d=o.addMonths(this.get("date"),n),c=0),e.preventDefault(),a=o.addDays(d,c),i=this.get("date"),h=o.addMonths(this.get("date"),this._paneNumber-1),l=new Date(h),h.setDate(o.daysInMonth(h)),o.isInRange(a,i,h)?this._highlightDateNode(a):o.isGreater(i,a)?o.isGreaterOrEqual(this.get("minimumDate"),i)||(this.set("date",o.addMonths(i,-1)),this._highlightDateNode(a)):o.isGreater(a,h)&&(o.isGreaterOrEqual(l,this.get("maximumDate"))||(this.set("date",o.addMonths(i,1)),this._highlightDateNode(a))))},_clickCalendar:function(e){var t,a=e.currentTarget,i=a.hasClass(l)&&!a.hasClass(n)&&!a.hasClass(d),h=a.hasClass(s);switch(this.get("selectionMode")){case"single":i&&(h||(this._clearSelection(!0),this._addDateToSelection(this._nodeToDate(a))));break;case"multiple-sticky":i&&(h?this._removeDateFromSelection(this._nodeToDate(a)):this._addDateToSelection(this._nodeToDate(a)));break;case"multiple":i&&(e.metaKey||e.ctrlKey||e.shiftKey?("macintosh"==u&&e.metaKey||"macintosh"!=u&&e.ctrlKey)&&!e.shiftKey?h?(this._removeDateFromSelection(this._nodeToDate(a)),this._lastSelectedDate=null):(this._lastSelectedDate=this._nodeToDate(a),this._addDateToSelection(this._lastSelectedDate)):("macintosh"==u&&e.metaKey||"macintosh"!=u&&e.ctrlKey)&&e.shiftKey?this._lastSelectedDate?(t=this._nodeToDate(a),this._addDateRangeToSelection(t,this._lastSelectedDate),this._lastSelectedDate=t):(this._lastSelectedDate=this._nodeToDate(a),this._addDateToSelection(this._lastSelectedDate)):e.shiftKey&&(this._lastSelectedDate?(t=this._nodeToDate(a),this._clearSelection(!0),this._addDateRangeToSelection(t,this._lastSelectedDate),this._lastSelectedDate=t):(this._clearSelection(!0),this._lastSelectedDate=this._nodeToDate(a),this._addDateToSelection(this._lastSelectedDate))):(this._clearSelection(!0),this._lastSelectedDate=this._nodeToDate(a),this._addDateToSelection(this._lastSelectedDate)))}i?this.fire("dateClick",{cell:a,date:this._nodeToDate(a)}):a.hasClass(n)?this.fire("prevMonthClick"):a.hasClass(d)&&this.fire("nextMonthClick")},subtractMonth:function(e){this.set("date",o.addMonths(this.get("date"),-1)),e&&e.halt()},subtractYear:function(e){this.set("date",o.addYears(this.get("date"),-1)),e&&e.halt()},addMonth:function(e){this.set("date",o.addMonths(this.get("date"),1)),e&&e.halt()},addYear:function(e){this.set("date",o.addYears(this.get("date"),1)),e&&e.halt()}},{NAME:"calendar",ATTRS:{selectionMode:{value:"single"},date:{value:new Date,lazyAdd:!1,setter:function(e){var t=this._normalizeDate(e),a=o.addMonths(t,this._paneNumber-1),i=this.get("minimumDate"),s=this.get("maximumDate");return i&&!o.isGreaterOrEqual(t,i)||s&&!o.isGreaterOrEqual(s,a)?i&&o.isGreater(i,t)?i:s&&o.isGreater(a,s)?o.addMonths(s,-1*(this._paneNumber-1)):void 0:t}},minimumDate:{value:null,setter:function(e){if(e){var t=this.get("date"),a=this._normalizeDate(e);return t&&!o.isGreaterOrEqual(t,a)&&this.set("date",a),a}return this._normalizeDate(e)}},maximumDate:{value:null,setter:function(e){if(e){var t=this.get("date"),a=this._normalizeDate(e);return t&&!o.isGreaterOrEqual(e,o.addMonths(t,this._paneNumber-1))&&this.set("date",o.addMonths(a,-1*(this._paneNumber-1))),a}return e}}}})},"@VERSION@",{requires:["calendar-base","calendarnavigator"],lang:["de","en","fr","ja","nb-NO","pt-BR","ru","zh-HANT-TW"],skinnable:!0});